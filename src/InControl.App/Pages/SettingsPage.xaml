<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="InControl.App.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Background="{ThemeResource LayerFillColorDefaultBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Padding="{StaticResource PageHeaderPadding}" Background="{ThemeResource SolidBackgroundFillColorBaseBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button x:Name="BackButton"
                    Grid.Column="0"
                    Style="{StaticResource PageBackButtonStyle}"
                    VerticalAlignment="Center">
                <FontIcon Glyph="&#xE72B;" FontSize="{StaticResource IconSizeMD}" />
            </Button>

            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock Text="Settings"
                           Style="{StaticResource PageTitleStyle}" />
                <TextBlock Text="Configure InControl preferences"
                           Style="{StaticResource PageSubtitleStyle}" />
            </StackPanel>

            <!-- Search Box -->
            <AutoSuggestBox Grid.Column="2"
                            x:Name="SettingsSearch"
                            PlaceholderText="Search settings..."
                            QueryIcon="Find"
                            Width="250"
                            VerticalAlignment="Center"
                            AutomationProperties.Name="Search settings"
                            AccessKey="F" />
        </Grid>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" Padding="{StaticResource PageContentPadding}">
            <StackPanel Spacing="{StaticResource SectionSpacing}" MaxWidth="{StaticResource ContentMaxWidth}">

                <!-- General Section -->
                <StackPanel x:Name="GeneralSection" Spacing="{StaticResource InlineSpacing}" Tag="theme light dark system startup launch minimize tray background">
                    <TextBlock Text="General"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Theme -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Theme" />
                                    <TextBlock Text="Choose light, dark, or system theme"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ComboBox Grid.Column="1" x:Name="ThemeComboBox" SelectedIndex="2" MinWidth="150"
                                          AutomationProperties.Name="Theme selection">
                                    <ComboBoxItem Content="Light" />
                                    <ComboBoxItem Content="Dark" />
                                    <ComboBoxItem Content="System" />
                                </ComboBox>
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Startup -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Launch at startup" />
                                    <TextBlock Text="Start InControl when Windows starts"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="False" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Minimize to tray -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Minimize to system tray" />
                                    <TextBlock Text="Keep InControl running in the background"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="True" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Models Section -->
                <StackPanel x:Name="ModelsSection" Spacing="{StaticResource InlineSpacing}" Tag="model default gpu cuda directml acceleration context length tokens">
                    <TextBlock Text="Models"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Default Model -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Default model" />
                                    <TextBlock Text="Model used for new sessions"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="OpenModelManagerButton" MinWidth="150">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE950;" FontSize="14" />
                                        <TextBlock Text="Open Model Manager" />
                                    </StackPanel>
                                </Button>
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- GPU Acceleration -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="GPU acceleration" />
                                    <TextBlock Text="Use CUDA/DirectML for faster inference"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="True" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Context Length -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Default context length" />
                                    <TextBlock Text="Maximum tokens for context window"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ComboBox Grid.Column="1" SelectedIndex="1" MinWidth="120">
                                    <ComboBoxItem Content="2048" />
                                    <ComboBoxItem Content="4096" />
                                    <ComboBoxItem Content="8192" />
                                    <ComboBoxItem Content="16384" />
                                </ComboBox>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Assistant Section -->
                <StackPanel x:Name="AssistantSection" Spacing="{StaticResource InlineSpacing}" Tag="assistant memory context sessions tool extensions">
                    <TextBlock Text="Assistant"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Memory -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Enable memory" />
                                    <TextBlock Text="Remember context across sessions"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="True" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Tool Access -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Tool access" />
                                    <TextBlock Text="Allow assistant to use extensions"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="True" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Memory Section -->
                <StackPanel x:Name="MemorySection" Spacing="{StaticResource InlineSpacing}" Tag="memory storage location clear history data">
                    <TextBlock Text="Memory"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Storage Location -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Storage location" />
                                    <TextBlock x:Name="StoragePathText"
                                               Text="~/.incontrol/memory"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="ChangeStorageButton" Content="Change..." />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Clear Memory -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Clear all memory" />
                                    <TextBlock Text="Remove all stored context and history"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="ClearMemoryButton" Content="Clear..." />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Extensions Section -->
                <StackPanel x:Name="ExtensionsSection" Spacing="{StaticResource InlineSpacing}" Tag="extensions plugins tools integrations install">
                    <TextBlock Text="Extensions"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Manage Extensions -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Manage extensions" />
                                    <TextBlock Text="Install, enable, or disable extensions"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="OpenExtensionsButton">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xEA86;" FontSize="14" />
                                        <TextBlock Text="Open Extensions" />
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Connectivity Section -->
                <StackPanel x:Name="ConnectivitySection" Spacing="{StaticResource InlineSpacing}" Tag="connectivity network offline policy connections internet">
                    <TextBlock Text="Connectivity"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Offline Mode -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Offline mode" />
                                    <TextBlock Text="Block all network connections"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" x:Name="OfflineModeToggle" IsOn="False" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Network Policy -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Network policy" />
                                    <TextBlock Text="Configure allowed connections"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="OpenPolicyButton" Content="Configure..." />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Updates Section -->
                <StackPanel x:Name="UpdatesSection" Spacing="{StaticResource InlineSpacing}" Tag="updates automatic version check download">
                    <TextBlock Text="Updates"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Auto Update -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Automatic updates" />
                                    <TextBlock Text="Check for updates on startup"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <ToggleSwitch Grid.Column="1" IsOn="True" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Check Now -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Current version" />
                                    <TextBlock Text="v1.0.0"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="CheckUpdatesButton" Content="Check for updates" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Diagnostics Section -->
                <StackPanel x:Name="DiagnosticsSection" Spacing="{StaticResource InlineSpacing}" Tag="diagnostics logs export reset defaults troubleshooting support">
                    <TextBlock Text="Diagnostics"
                               Style="{StaticResource SectionHeaderStyle}" />

                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel Spacing="{StaticResource ItemSpacing}">
                            <!-- Export Logs -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Export diagnostics" />
                                    <TextBlock Text="Create a support bundle for troubleshooting"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="ExportDiagnosticsButton" Content="Export..." />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Open Logs Folder -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Log files" />
                                    <TextBlock Text="View application logs"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="OpenLogsButton" Content="Open folder" />
                            </Grid>

                            <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                            <!-- Reset -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Reset to defaults" />
                                    <TextBlock Text="Restore all settings to their default values"
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                                <Button Grid.Column="1" x:Name="ResetSettingsButton" Content="Reset..." />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- No Results Found (for search) -->
                <Border x:Name="NoResultsPanel"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="48"
                        Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" Spacing="12">
                        <FontIcon Glyph="&#xE721;"
                                  FontSize="32"
                                  Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                  HorizontalAlignment="Center" />
                        <TextBlock x:Name="NoResultsText"
                                   Text="No settings found"
                                   Style="{StaticResource BodyStrongTextBlockStyle}"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="Try a different search term"
                                   Style="{StaticResource CaptionTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>

                <!-- Bottom Spacer -->
                <Border Height="24" />

            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
