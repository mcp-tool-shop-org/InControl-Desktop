<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="InControl.App.Pages.AssistantPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Background="{ThemeResource LayerFillColorDefaultBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Padding="24,16" Background="{ThemeResource SolidBackgroundFillColorBaseBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button x:Name="BackButton"
                    Grid.Column="0"
                    Padding="8"
                    Background="Transparent"
                    BorderThickness="0"
                    ToolTipService.ToolTip="Back"
                    VerticalAlignment="Center"
                    Margin="0,0,12,0">
                <FontIcon Glyph="&#xE72B;" FontSize="16" />
            </Button>

            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock Text="Assistant"
                           Style="{StaticResource TitleTextBlockStyle}" />
                <TextBlock Text="View and configure assistant behavior"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                <Ellipse x:Name="AssistantStatusIndicator"
                         Width="8" Height="8"
                         Fill="{ThemeResource SystemFillColorSuccessBrush}"
                         VerticalAlignment="Center"
                         Margin="0,0,8,0" />
                <TextBlock x:Name="AssistantStatusText"
                           Text="Active"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           VerticalAlignment="Center" />
            </StackPanel>
        </Grid>

        <!-- Content -->
        <Grid Grid.Row="1" Padding="24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="360" />
            </Grid.ColumnDefinitions>

            <!-- Main Content -->
            <Grid Grid.Column="0" Margin="0,0,16,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Tabs -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="16" Margin="0,0,0,16">
                    <RadioButton x:Name="MemoryTab" Content="Memory" IsChecked="True" GroupName="AssistantTabs" />
                    <RadioButton x:Name="ToolsTab" Content="Tools" GroupName="AssistantTabs" />
                    <RadioButton x:Name="ActivityTab" Content="Activity" GroupName="AssistantTabs" />
                </StackPanel>

                <!-- Memory View -->
                <Border x:Name="MemoryView"
                        Grid.Row="1"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!-- Memory Header -->
                        <Grid Grid.Row="0" Padding="16" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock Text="Stored Memories"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock x:Name="MemoryCountText"
                                           Text="0 items"
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                            </StackPanel>
                            <Button Grid.Column="1" x:Name="ClearMemoryButton" Content="Clear All" />
                        </Grid>

                        <!-- Memory List or Empty State -->
                        <Grid Grid.Row="1" Padding="16">
                            <!-- Empty State -->
                            <StackPanel x:Name="MemoryEmptyState"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Spacing="12">
                                <FontIcon Glyph="&#xE7C3;"
                                          FontSize="40"
                                          Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                          HorizontalAlignment="Center" />
                                <TextBlock Text="No memories stored"
                                           Style="{StaticResource SubtitleTextBlockStyle}"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="The assistant will remember important context as you interact."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           TextWrapping="Wrap"
                                           TextAlignment="Center"
                                           MaxWidth="300" />
                            </StackPanel>

                            <!-- Memory ListView -->
                            <ListView x:Name="MemoryListView"
                                      Visibility="Collapsed"
                                      SelectionMode="None">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel>
                                                <TextBlock Text="{Binding Content}"
                                                           TextWrapping="Wrap" />
                                                <TextBlock Text="{Binding Timestamp}"
                                                           Style="{StaticResource CaptionTextBlockStyle}"
                                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                            </StackPanel>
                                            <Button Grid.Column="1"
                                                    Padding="8"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    ToolTipService.ToolTip="Remove">
                                                <FontIcon Glyph="&#xE74D;" FontSize="12" />
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Tools View -->
                <Border x:Name="ToolsView"
                        Grid.Row="1"
                        Visibility="Collapsed"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="16">
                    <ScrollViewer>
                        <StackPanel Spacing="12">
                            <TextBlock Text="Available Tools"
                                       Style="{StaticResource SubtitleTextBlockStyle}"
                                       Margin="0,0,0,8" />

                            <!-- Tool Items -->
                            <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="6"
                                    Padding="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Glyph="&#xE721;" FontSize="20" Margin="0,0,12,0" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Web Search" />
                                        <TextBlock Text="Search the web for information"
                                                   Style="{StaticResource CaptionTextBlockStyle}"
                                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                    </StackPanel>
                                    <ToggleSwitch Grid.Column="2" IsOn="True" />
                                </Grid>
                            </Border>

                            <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="6"
                                    Padding="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Glyph="&#xE943;" FontSize="20" Margin="0,0,12,0" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Code Execution" />
                                        <TextBlock Text="Run code snippets safely"
                                                   Style="{StaticResource CaptionTextBlockStyle}"
                                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                    </StackPanel>
                                    <ToggleSwitch Grid.Column="2" IsOn="False" />
                                </Grid>
                            </Border>

                            <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="6"
                                    Padding="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Glyph="&#xE8A5;" FontSize="20" Margin="0,0,12,0" />
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="File Access" />
                                        <TextBlock Text="Read and write local files"
                                                   Style="{StaticResource CaptionTextBlockStyle}"
                                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                    </StackPanel>
                                    <ToggleSwitch Grid.Column="2" IsOn="True" />
                                </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Activity View -->
                <Border x:Name="ActivityView"
                        Grid.Row="1"
                        Visibility="Collapsed"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Recent Activity"
                                       Style="{StaticResource SubtitleTextBlockStyle}" />
                            <Button Grid.Column="1" x:Name="ClearActivityButton" Content="Clear" />
                        </Grid>

                        <ScrollViewer Grid.Row="1">
                            <StackPanel x:Name="ActivityList" Spacing="8">
                                <!-- Activity items would be added dynamically -->
                                <TextBlock Text="No recent activity"
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           Margin="0,40,0,0" />
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>

            <!-- Info Panel -->
            <Border Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8"
                    Padding="20">
                <ScrollViewer>
                    <StackPanel Spacing="20">

                        <!-- Assistant Status -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Status"
                                       Style="{StaticResource SubtitleTextBlockStyle}" />
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Assistant enabled"
                                           VerticalAlignment="Center" />
                                <ToggleSwitch Grid.Column="1" x:Name="AssistantEnabledToggle" IsOn="True" />
                            </Grid>
                        </StackPanel>

                        <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                        <!-- Behavior Settings -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="Behavior"
                                       Style="{StaticResource SubtitleTextBlockStyle}" />

                            <ComboBox x:Name="ResponseStyleSelector"
                                      Header="Response style"
                                      HorizontalAlignment="Stretch"
                                      SelectedIndex="1">
                                <ComboBoxItem Content="Concise" />
                                <ComboBoxItem Content="Balanced" />
                                <ComboBoxItem Content="Detailed" />
                            </ComboBox>

                            <Slider x:Name="CreativitySlider"
                                    Header="Creativity (Temperature)"
                                    Minimum="0"
                                    Maximum="1"
                                    Value="0.7"
                                    StepFrequency="0.1" />
                        </StackPanel>

                        <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                        <!-- Memory Settings -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="Memory"
                                       Style="{StaticResource SubtitleTextBlockStyle}" />

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Remember conversations"
                                           VerticalAlignment="Center" />
                                <ToggleSwitch Grid.Column="1" x:Name="RememberToggle" IsOn="True" />
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Learn preferences"
                                           VerticalAlignment="Center" />
                                <ToggleSwitch Grid.Column="1" x:Name="LearnToggle" IsOn="True" />
                            </Grid>
                        </StackPanel>

                        <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" />

                        <!-- Instructions -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Custom Instructions"
                                       Style="{StaticResource SubtitleTextBlockStyle}" />
                            <TextBlock Text="Add instructions the assistant should always follow."
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" />
                            <TextBox x:Name="InstructionsBox"
                                     PlaceholderText="e.g., Always respond in bullet points..."
                                     TextWrapping="Wrap"
                                     AcceptsReturn="True"
                                     Height="100" />
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>
