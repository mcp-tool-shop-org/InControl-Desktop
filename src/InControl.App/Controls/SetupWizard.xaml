<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="InControl.App.Controls.SetupWizard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:InControl.App.Controls">

    <Grid Padding="48"
          MaxWidth="600"
          HorizontalAlignment="Center"
          VerticalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header with Progress -->
        <StackPanel Grid.Row="0" Spacing="16">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock x:Name="StepIndicator"
                           Text="Step 1 of 4"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
            </StackPanel>

            <TextBlock x:Name="StepTitle"
                       Text="Welcome to InControl"
                       Style="{StaticResource TitleTextBlockStyle}" />

            <TextBlock x:Name="StepDescription"
                       Text="A local AI workstation for your RTX GPU."
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                       TextWrapping="Wrap" />
        </StackPanel>

        <!-- Step Content -->
        <Grid Grid.Row="1" Margin="0,32,0,32">
            <!-- Welcome Step -->
            <StackPanel x:Name="WelcomeContent"
                        Spacing="24"
                        VerticalAlignment="Center"
                        Visibility="Visible">
                <FontIcon Glyph="&#xE8BD;"
                          FontSize="64"
                          Foreground="{ThemeResource AccentFillColorDefaultBrush}"
                          HorizontalAlignment="Center" />

                <StackPanel Spacing="12" HorizontalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE72E;" FontSize="16"
                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <TextBlock Text="Everything runs locally on your machine"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE785;" FontSize="16"
                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <TextBlock Text="Your data stays on your device"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE9A1;" FontSize="16"
                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <TextBlock Text="Optimized for RTX GPUs"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <!-- Backend Check Step -->
            <StackPanel x:Name="BackendCheckContent"
                        Spacing="24"
                        VerticalAlignment="Center"
                        Visibility="Collapsed">
                <Grid HorizontalAlignment="Center">
                    <ProgressRing x:Name="BackendSearchRing"
                                  IsActive="True"
                                  Width="48"
                                  Height="48" />
                    <FontIcon x:Name="BackendConnectedIcon"
                              Glyph="&#xE73E;"
                              FontSize="48"
                              Foreground="{ThemeResource SystemFillColorSuccessBrush}"
                              Visibility="Collapsed" />
                </Grid>

                <TextBlock x:Name="BackendStatusText"
                           Text="Searching for backend..."
                           HorizontalAlignment="Center"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

                <StackPanel Spacing="8" HorizontalAlignment="Center">
                    <TextBlock Text="InControl works with:"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                               HorizontalAlignment="Center" />

                    <StackPanel Orientation="Horizontal" Spacing="16" HorizontalAlignment="Center">
                        <TextBlock Text="Ollama"
                                   Style="{StaticResource CaptionTextBlockStyle}" />
                        <TextBlock Text="llama.cpp"
                                   Style="{StaticResource CaptionTextBlockStyle}" />
                        <TextBlock Text="LM Studio"
                                   Style="{StaticResource CaptionTextBlockStyle}" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <!-- Model Selection Step -->
            <StackPanel x:Name="ModelSelectionContent"
                        Spacing="16"
                        VerticalAlignment="Center"
                        Visibility="Collapsed">
                <ComboBox x:Name="ModelSelector"
                          PlaceholderText="Select a model"
                          HorizontalAlignment="Stretch"
                          SelectionChanged="ModelSelector_SelectionChanged">
                    <!-- Models will be populated from code -->
                </ComboBox>

                <TextBlock x:Name="ModelDescription"
                           Text="Select a model to get started"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           TextWrapping="Wrap" />

                <HyperlinkButton Content="How do I get models?"
                                 HorizontalAlignment="Center" />
            </StackPanel>

            <!-- Ready Step -->
            <StackPanel x:Name="ReadyContent"
                        Spacing="24"
                        VerticalAlignment="Center"
                        Visibility="Collapsed">
                <FontIcon Glyph="&#xE73E;"
                          FontSize="64"
                          Foreground="{ThemeResource SystemFillColorSuccessBrush}"
                          HorizontalAlignment="Center" />

                <StackPanel Spacing="8" HorizontalAlignment="Center">
                    <TextBlock x:Name="ReadyModelText"
                               Text="llama3.2"
                               Style="{StaticResource SubtitleTextBlockStyle}"
                               HorizontalAlignment="Center" />

                    <TextBlock Text="is ready to use"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               HorizontalAlignment="Center" />
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- Navigation Buttons -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button x:Name="BackButton"
                    Grid.Column="0"
                    Content="Back"
                    Click="BackButton_Click"
                    Visibility="Collapsed" />

            <Button x:Name="SkipButton"
                    Grid.Column="0"
                    Content="Skip"
                    Click="SkipButton_Click"
                    Visibility="Visible" />

            <Button x:Name="NextButton"
                    Grid.Column="2"
                    Content="Get Started"
                    
                    Click="NextButton_Click" />
        </Grid>
    </Grid>
</UserControl>
