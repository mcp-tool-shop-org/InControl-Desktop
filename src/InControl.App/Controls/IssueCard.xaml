<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="InControl.App.Controls.IssueCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:InControl.App.Controls">

    <!--
    Issue Card: Displays errors/warnings with recovery actions
    Per UX contract:
    - No blame language - state facts, provide context
    - Calm visual tone - not alarming red unless truly critical
    - Always offer next steps or actions
    - Suggestions help users understand what to try
    -->
    <Border x:Name="CardBorder"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="8"
            Padding="16">
        <Grid RowSpacing="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Header: Icon + Title + Dismiss -->
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Severity Icon -->
                <FontIcon Grid.Column="0"
                          x:Name="SeverityIcon"
                          Glyph="&#xE7BA;"
                          FontSize="20"
                          VerticalAlignment="Center"
                          Margin="0,0,12,0" />

                <!-- Title -->
                <TextBlock Grid.Column="1"
                           x:Name="TitleText"
                           Text="Issue title"
                           Style="{StaticResource BodyStrongTextBlockStyle}"
                           VerticalAlignment="Center"
                           TextTrimming="CharacterEllipsis" />

                <!-- Dismiss Button -->
                <Button Grid.Column="2"
                        x:Name="DismissButton"
                        Style="{StaticResource GhostButtonStyle}"
                        ToolTipService.ToolTip="Dismiss"
                        Padding="4">
                    <FontIcon Glyph="&#xE711;" FontSize="12" />
                </Button>
            </Grid>

            <!-- Detail Text -->
            <TextBlock Grid.Row="1"
                       x:Name="DetailText"
                       Text="Issue details"
                       TextWrapping="Wrap"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

            <!-- Suggestions (What to try) -->
            <StackPanel Grid.Row="2"
                        x:Name="SuggestionsPanel"
                        Spacing="4"
                        Visibility="Collapsed">
                <TextBlock Text="What to try:"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           FontWeight="SemiBold" />
                <ItemsControl x:Name="SuggestionsList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="â€¢"
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                                <TextBlock Text="{Binding}"
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           TextWrapping="Wrap" />
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- Recovery Actions -->
            <StackPanel Grid.Row="3"
                        x:Name="ActionsPanel"
                        Orientation="Horizontal"
                        Spacing="8"
                        Visibility="Collapsed">
                <!-- Actions will be populated dynamically -->
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
