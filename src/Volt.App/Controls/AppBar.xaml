<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Volt.App.Controls.AppBar"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Volt.App.Controls">

    <Grid Height="48"
          Background="{ThemeResource LayerFillColorDefaultBrush}"
          BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
          BorderThickness="0,0,0,1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!-- App Name -->
        <TextBlock Grid.Column="0"
                   Text="Volt"
                   Style="{StaticResource TitleTextBlockStyle}"
                   VerticalAlignment="Center"
                   Margin="16,0,24,0" />

        <!-- Model Selector -->
        <ComboBox Grid.Column="1"
                  x:Name="ModelSelector"
                  PlaceholderText="Select model"
                  VerticalAlignment="Center"
                  MinWidth="200"
                  MaxWidth="300">
            <!-- Models will be populated dynamically -->
        </ComboBox>

        <!-- Status Capsule -->
        <Border Grid.Column="2"
                x:Name="StatusCapsule"
                CornerRadius="4"
                Padding="12,4"
                VerticalAlignment="Center"
                Margin="16,0"
                Background="{ThemeResource SubtleFillColorSecondaryBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Idle/Complete State -->
                <StackPanel Grid.Column="0"
                            x:Name="IdleState"
                            Orientation="Horizontal"
                            Spacing="8">
                    <Ellipse Width="8" Height="8"
                             x:Name="StatusIndicator"
                             Fill="{ThemeResource SystemFillColorSuccessBrush}"
                             VerticalAlignment="Center" />
                    <TextBlock x:Name="StatusText"
                               Text="Idle"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               VerticalAlignment="Center" />
                </StackPanel>

                <!-- Executing State -->
                <StackPanel Grid.Column="0"
                            x:Name="ExecutingState"
                            Orientation="Horizontal"
                            Spacing="8"
                            Visibility="Collapsed">
                    <ProgressRing x:Name="ExecutingProgress"
                                  IsActive="False"
                                  Width="14"
                                  Height="14"
                                  VerticalAlignment="Center" />
                    <TextBlock x:Name="ExecutingText"
                               Text="Running..."
                               Style="{StaticResource CaptionTextBlockStyle}"
                               VerticalAlignment="Center" />
                </StackPanel>

                <!-- Elapsed Time (shown during execution) -->
                <TextBlock Grid.Column="1"
                           x:Name="ElapsedTimeText"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                           VerticalAlignment="Center"
                           Margin="8,0,0,0"
                           Visibility="Collapsed" />

                <!-- Cancel Button (shown during execution) -->
                <Button Grid.Column="2"
                        x:Name="CancelButton"
                        Content="Cancel"
                        Padding="6,2"
                        Margin="8,0,0,0"
                        FontSize="11"
                        VerticalAlignment="Center"
                        Visibility="Collapsed">
                    <Button.KeyboardAccelerators>
                        <KeyboardAccelerator Key="Escape" />
                    </Button.KeyboardAccelerators>
                </Button>
            </Grid>
        </Border>

        <!-- Global Search (Ctrl+K placeholder) -->
        <Button Grid.Column="3"
                x:Name="SearchButton"
                VerticalAlignment="Center"
                Margin="0,0,16,0"
                ToolTipService.ToolTip="Search (Ctrl+K)">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <FontIcon Glyph="&#xE721;" FontSize="14" />
                <TextBlock Text="Search"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                        CornerRadius="2"
                        Padding="4,2">
                    <TextBlock Text="Ctrl+K"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                </Border>
            </StackPanel>
        </Button>
    </Grid>
</UserControl>
